(()=>{"use strict";addEventListener("DOMContentLoaded",(()=>{!function(){const e=document.querySelector(".js-login"),t="is-active",n="submit-status";if(!e)return;e.addEventListener("submit",(function(e){if(!e.target.classList.contains("has-errors")){let a=e.target,o=a.dataset.url,l=a.querySelectorAll(".login__tab"),i=a.querySelector(".js-otp"),c=new FormData(a),u=(o.includes("?")?"&":"?")+new URLSearchParams(c).toString();o+=u,(async()=>{try{let e=await fetch(o);if(!e.ok)return;let a=await e.json();!0===a.status?a.url?window.location.assign(a.url):(l.forEach((e=>{e.classList.toggle(t),e.removeAttribute("disabled")})),r.forEach((e=>{e.value=""})),i.focus(),function(){const e=document.querySelector(".otp__timer span"),n=e.closest("form").querySelectorAll(".login__tab");let r=e.parentElement.dataset.timer;e.textContent=r--;const s=setInterval((()=>{e.textContent=r,0===r?(clearInterval(s),n.forEach((e=>{e.classList.contains(t)&&e.setAttribute("disabled",""),e.classList.toggle(t)}))):r--}),1e3)}()):function(e=!1){if(r.forEach((e=>{e.classList.add(s)})),e.message){const t=document.createElement("div"),r=document.querySelector(".otp__footer");t.classList.add(n,"submit-status_error"),t.innerHTML=e.message;let s=document.querySelector(`.${n}`);s&&s.remove(),r.prepend(t)}}(a)}catch(e){return void console.error(e)}})()}}));const r=document.querySelectorAll(".js-otp"),s="is-error";function a(e){let t=e.clipboardData.getData("text");t=t.replace(/\D/g,""),t=t.substring(0,r.length);let n=t.split("");r.forEach(((t,r)=>{if(!(Number.parseInt(n[r])>=0))return e.stopPropagation(),e.preventDefault(),!1;t.value=n[r],t.blur()})),l()}function o(e){let t=e.target,n=t.dataset.index;if(!e.ctrlKey&&"v"!==e.key)if("Backspace"==e.key||"Delete"==e.key)e.stopPropagation(),e.preventDefault(),t.value="",n>0&&setTimeout((()=>t.previousElementSibling.focus()),0);else{let s=e.key.replace(/\D/g,"");if(""==s)return e.stopPropagation(),e.preventDefault(),!1;0==t.value.length&&(t.value=s),n<r.length-1&&setTimeout((()=>t.nextElementSibling.focus()),0)}n==r.length-1&&(t.classList.add("is-blur-otp"),l())}function l(){let t=Array.from(r).map((e=>e.value)).join(""),n=document.querySelector('.otp input[name="f"]');t.length==r.length&&(n.value=t,e.dispatchEvent(new Event("submit")))}r&&r.forEach(((e,t)=>{e.dataset.index=t,e.addEventListener("paste",a),e.addEventListener("keydown",o),e.addEventListener("focus",(()=>{e.classList.remove("is-blur-otp"),function(){r.forEach((e=>{e.classList.remove(s)}));let e=document.querySelector(`.${n}`);e&&e.remove()}()}))}))}()}))})();