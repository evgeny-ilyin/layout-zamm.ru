(()=>{"use strict";addEventListener("DOMContentLoaded",(()=>{!function(){const e=document.querySelector(".js-login"),t="is-active";if(!e)return;e.addEventListener("submit",(function(e){if(!e.target.classList.contains("has-errors")){let a=e.target,s=a.action,o=a.querySelectorAll(".login__tab"),l=a.querySelector(".js-otp"),i=new FormData(a),c=(s.includes("?")?"&":"?")+new URLSearchParams(i).toString();s+=c,(async()=>{try{let e=await fetch(s);if(!e.ok)return;let a=await e.json();!0===a.status?a.url?window.location.assign(a.url):(o.forEach((e=>{e.classList.toggle(t),e.removeAttribute("disabled")})),l.focus(),function(){const e=document.querySelector(".otp__timer span"),n=e.closest("form").querySelectorAll(".login__tab");let r=e.parentElement.dataset.timer;e.textContent=r--;const a=setInterval((()=>{e.textContent=r,0===r?(clearInterval(a),n.forEach((e=>{e.classList.contains(t)&&e.setAttribute("disabled",""),e.classList.toggle(t)}))):r--}),1e3)}()):(a.error,n.forEach((e=>{e.classList.add(r)})))}catch(e){return void console.error(e)}})()}}));const n=document.querySelectorAll(".js-otp"),r="is-error";function a(e){let t=e.clipboardData.getData("text");t=t.replace(/\D/g,""),t=t.substring(0,n.length);let r=t.split("");n.forEach(((t,n)=>{if(!Number.parseInt(r[n]))return e.stopPropagation(),e.preventDefault(),!1;t.value=r[n],t.blur()})),o()}function s(e){let t=e.target,r=t.dataset.index;if(!e.ctrlKey&&"v"!==e.key)if("Backspace"==e.key||"Delete"==e.key)e.stopPropagation(),e.preventDefault(),t.value="",r>0&&setTimeout((()=>t.previousElementSibling.focus()),0);else{let a=e.key.replace(/\D/g,"");if(""==a)return e.stopPropagation(),e.preventDefault(),!1;0==t.value.length&&(t.value=a),r<n.length-1&&setTimeout((()=>t.nextElementSibling.focus()),0)}r==n.length-1&&(t.classList.add("is-blur-otp"),o())}function o(){let t=Array.from(n).map((e=>e.value)).join(""),r=document.querySelector('.otp input[name="f"]');t.length==n.length&&(r.value=t,e.dispatchEvent(new Event("submit")))}n&&n.forEach(((e,t)=>{e.dataset.index=t,e.addEventListener("paste",a),e.addEventListener("keydown",s),e.addEventListener("focus",(()=>{e.classList.remove("is-blur-otp"),n.forEach((e=>{e.classList.remove(r)}))}))}))}()}))})();