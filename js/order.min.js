(()=>{"use strict";function t(t,e){let a=t.dataset.url,r="get"==e.dataset.method?"get":"post",o=e.dataset.params,s=t.querySelector("form"),n=new FormData(s);if(o){let t=JSON.parse(o);Object.keys(t).forEach((e=>{n.set(e,t[e])}))}if("get"==r){let e=(a.includes("?")?"&":"?")+new URLSearchParams(n).toString();a+=e,(async()=>{try{fetchLoader([t],"start");let e=await fetch(a);if(!e.ok)return;let r=await e.json();!0===r.status&&(updateChunks(r.chunks),selectsInit(),globalForm.validation()),fetchLoader([t],"stop")}catch(t){return void console.error(t)}})()}else(async()=>{try{fetchLoader([t],"start");let e=await fetch(a,{method:"POST",body:n});if(!e.ok)return;let r=await e.json();!0===r.status&&(updateChunks(r.chunks),selectsInit(),globalForm.validation()),fetchLoader([t],"stop")}catch(t){return void console.error(t)}})()}function e(e,a){const r=a.querySelector(".js-promocode-submit");r&&r.previousElementSibling.value.length&&t(e,r)}addEventListener("DOMContentLoaded",(()=>{!function(){const a=document.querySelector(".js-order");a&&(document.addEventListener("change",(e=>{if("true"!=e.target.dataset.watch||e.target.dataset.query||t(a,e.target),e.target.closest(".form-agreement")){const t=a.querySelector('button[type="submit"]');!0===e.target.checked?t.disabled=!1:t.disabled=!0}})),document.addEventListener("queryResult",(e=>{"true"==e.target.dataset.watch&&"true"==e.target.dataset.query&&e.target.value.length>0&&t(a,e.target)})),document.addEventListener("keydown",(t=>{if(t.target.closest(".js-promocode-input")&&"Enter"==t.key){const r=t.target.parentElement;e(a,r)}})),document.addEventListener("click",(t=>{if("true"==t.target.dataset.watch&&t.target.closest(".js-promocode-submit")){const r=t.target.closest(".js-promocode-submit").parentElement;e(a,r)}})),document.addEventListener("click",(e=>{if("true"==e.target.dataset.watch&&e.target.closest(".js-promocode-remove")){const r=e.target.closest(".js-promocode-remove");!function(e,a){t(e,a)}(a,r)}})))}()}))})();