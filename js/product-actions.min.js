(()=>{"use strict";function t(t,e){const a=t.closest("form")||t.closest(".item__props").querySelector("form");let s=new FormData(a),r=t.dataset.url,o=t.dataset.id;s.append("trigger",e),s.append("id",o),(async()=>{try{btnLoader(t);let e=await fetch(r,{method:"POST",body:s});if(!e.ok)return;let a=await e.json();if(!0===a.status){t.classList.add("in-cart");let e=document.querySelector('[data-id="amount"]');if(!e)return;e.dataset.amount=a.amount}btnLoader(t,"stop")}catch(t){return void console.error(t)}})()}addEventListener("DOMContentLoaded",(()=>{document.addEventListener("click",(e=>{if(e.target.closest(".js-add-to-cart")){let a=e.target.closest(".js-add-to-cart"),s="",r="in-cart";if(!a)return;if(a.classList.contains(r)&&a.dataset.cart)return void window.location.assign(a.dataset.cart);a.closest(".item")&&(s="addItemCatalog"),a.closest(".product")&&(s="addItem"),t(a,s)}})),document.addEventListener("change",(e=>{if("amount"==e.target.name){let a=e.target.closest(".product__purchase").querySelector(".js-add-to-cart"),s="";if(!a)return;a.closest(".product")&&(s="changeAmount"),t(a,s)}})),document.addEventListener("click",(t=>{const e=t.target.closest(".js-fav");if(!e)return;const a=e.dataset.id,s=e.dataset.url,r={id:a};(async()=>{try{let t=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r)});if(!t.ok)return;!0===(await t.json()).status&&e.parentElement.classList.toggle("is-active")}catch(t){return void console.error(t)}})()}))}))})();