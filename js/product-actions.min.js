(()=>{"use strict";function t(t){const e=t.closest("form")||t.closest(".item__props").querySelector("form");let a=new FormData(e),s={},o={},n=t.dataset.url,r=t.dataset.id,c=Object.fromEntries(a.entries());s={id:r},t.dataset.params&&(o=JSON.parse(t.dataset.params)),Object.assign(s,o,c),(async()=>{try{btnLoader(t);let e=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(s)});if(!e.ok)return;let a=await e.json();if(!0===a.status){t.classList.add("in-cart");let e=document.querySelector('[data-id="amount"]');if(!e)return void console.log("data-id amount not found");e.dataset.amount=a.amount}btnLoader(t,"stop")}catch(t){return void console.log(t)}})()}document.addEventListener("click",(e=>{if(e.target.closest(".js-add-to-cart")){let a=e.target.closest(".js-add-to-cart"),s="in-cart";if(!a)return;if(a.classList.contains(s)&&a.dataset.cart)return void window.location.assign(a.dataset.cart);t(a)}})),document.addEventListener("change",(e=>{if("amount"==e.target.name){let a=e.target.closest(".product__purchase").querySelector(".js-add-to-cart");if(!a)return;t(a)}})),addEventListener("DOMContentLoaded",(()=>{document.addEventListener("click",(t=>{const e=t.target.closest(".js-fav");if(!e)return;const a=e.dataset.id,s=e.dataset.url,o={id:a};(async()=>{try{let t=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(o)});if(!t.ok)return;!0===(await t.json()).status&&e.parentElement.classList.toggle("is-active")}catch(t){return void console.log(t)}})()}))}))})();