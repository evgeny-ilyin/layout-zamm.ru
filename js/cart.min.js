(()=>{"use strict";function t(t,e,a){const r=t.dataset.url,d=t.querySelector("form");let o=new FormData(d),s=Object.fromEntries(o.entries()),c=new FormData;c.append("trigger",a),c.append("itemId",e),c.append("formData",JSON.stringify(s)),(async()=>{try{fetchLoader([t],"start");let a=await fetch(r,{method:"POST",body:c});if(!a.ok)return;let d=await a.json();if(!0===d.status){if(carouselsInit(),catalogItemGalleriesInit(),catalogItemGalleryHandler(),d.chunks&&updateChunks(d.chunks),d.addedId||d.removedId){let t=d.addedId||d.removedId;const e=document.querySelector(`button[data-id="${t}"]`);if(e){const t=e.closest(".item__details");d.addedId?(e.classList.add("in-cart"),t.style.opacity=1):d.removedId&&(e.classList.remove("in-cart"),t.style.opacity="")}}if(!isNaN(d.currentAmount)&&d.currentAmount>1){const t=document.querySelector(`[data-id="${e}"] .amount-element input`);if(!t)return;t.value=d.currentAmount}}fetchLoader([t],"stop")}catch(t){return void console.error(t)}})()}addEventListener("DOMContentLoaded",(()=>{!function(){const e=document.querySelector(".js-cart");e&&(document.addEventListener("change",(a=>{if(a.target.closest(".cart-item")){let r=a.target.closest(".cart-item").dataset.itemId;t(e,r,"changeAmountCart")}})),e.addEventListener("click",(a=>{if(a.target.closest(".js-remove-from-cart")){let r=a.target.closest(".cart-item").dataset.itemId;t(e,r,"removeItemCart")}if(a.target.closest(".js-add-to-cart")){let r=a.target.closest(".js-add-to-cart").dataset.id;t(e,r,"addItemCart")}})))}()}))})();